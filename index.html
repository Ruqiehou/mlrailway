<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤©ç‹æ…•æ°è”é‚¦å¸å›½é“è·¯ç¥¨ä»·ç³»ç»Ÿ</title>
    <style>
        body { font-family: "Microsoft YaHei", sans-serif; text-align: center; padding: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        select, button { padding: 10px; margin: 10px; font-size: 16px; border-radius: 5px; }
        button { background: #1a5fb4; color: white; cursor: pointer; }
        .result { font-size: 20px; margin: 20px; color: #d32f2f; font-weight: bold; }
        .tip { color: #666; font-size: 14px; }
        .seat-option { margin: 10px 0; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸš„ å¤©ç‹æ…•æ°è”é‚¦å¸å›½é“è·¯ç¥¨ä»·ç³»ç»Ÿ</h1>
    <p class="tip">ç³»ç»Ÿå°†æ ¹æ®åœ°å›¾ä¸å®˜æ–¹ç¥¨ä»·è¡¨ï¼Œè‡ªåŠ¨è®¡ç®—ä¸¤åœ°é—´æœ€ä¾¿å®œçš„è·¯çº¿</p>

    <div>
        <label for="start">å‡ºå‘è½¦ç«™:</label>
        <select id="start"></select>
    </div>

    <div>
        <label for="end">åˆ°è¾¾è½¦ç«™:</label>
        <select id="end"></select>
    </div>

    <div class="seat-option">
        <label>åº§ä½ç­‰çº§:</label>
        <input type="radio" id="yibei" name="seat" value="yibei" checked> <label for="yibei">ä¹™ç­‰åº§</label>
        <input type="radio" id="jia" name="seat" value="jia"> <label for="jia">ç”²ç­‰åº§</label>
    </div>

    <button onclick="findCheapestRoute()">ğŸ’° è®¡ç®—æœ€ä¾¿å®œç¥¨ä»·</button>

    <div class="result" id="result">ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
</div>

<script>
    // ==================================================================================
    // 1. ã€é…ç½®åŒºã€‘åœ°åŒºè¿æ¥å…³ç³» (ä¹™ç­‰åº§çš„è·¨åŒºåŠ ä»·ï¼Œæ ¹æ®ä½ æä¾›çš„åå•)
    // ==================================================================================
    const connections = {
        'ä¹‰å®‰': { 'æ¸…æ’': 300, 'æ™¯åœ£': 200, 'é¢œç³»': 400, 'æ½®å·': 200 },
        'æ¸…æ’': { 'ä¹‰å®‰': 300, 'å…‰è¾°': 300, 'æ™¯åœ£': 200, 'é¢œç³»': 400 },
        'å…‰è¾°': { 'æ¸…æ’': 300, 'å…´åº†': 300, 'æ¥šç³»': 200 },
        'å…´åº†': { 'å…‰è¾°': 300, 'æ½®å·': 300, 'å‡Œç³»': 300, 'äº‘ç³»': 500 },
        'æ½®å·': { 'å…´åº†': 300, 'ä¹‰å®‰': 200, 'äº‘ç³»': 200 },
        'å‡Œç³»': { 'å…´åº†': 300, 'å¤©è½©': 300 },
        'å¤©è½©': { 'å‡Œç³»': 300, 'äº‘ç³»': 300, 'é™‡ç³»': 400 },
        'äº‘ç³»': { 'å…´åº†': 500, 'å¤©è½©': 300, 'æ½®å·': 200 },
        'æ¥šç³»': { 'å…‰è¾°': 200, 'å”ç³»': 300, 'æ®·ç³»': 300, 'æ™¯åœ£': 300, 'é¢œç³»': 400 },
        'å”ç³»': { 'æ¥šç³»': 300, 'é™‡ç³»': 300 },
        'é™‡ç³»': { 'å”ç³»': 300, 'å¤©è½©': 400 },
        'æ®·ç³»': { 'æ¥šç³»': 300, 'æ™¯åœ£': 300, 'é¢œç³»': 400 },
        'æ™¯åœ£': { 'æ¥šç³»': 300, 'æ®·ç³»': 300, 'ä¹‰å®‰': 200, 'æ¸…æ’': 200 },
        'é¢œç³»': { 'æ¥šç³»': 400, 'æ®·ç³»': 400, 'ä¹‰å®‰': 400, 'æ¸…æ’': 400 }
    };

    // ==================================================================================
    // 2. ã€é…ç½®åŒºã€‘è½¦ç«™å½’å±å…³ç³» (æ ¹æ®ä½ æä¾›çš„â€œçœŸå®è½¦ç«™æ•°æ®â€)
    // ==================================================================================
    const stations = {
        // â– äº¬ç•¿éƒ½å¸‚åœˆ
        "ä¹‰å®‰ç«™": "ä¹‰å®‰", "ä¹‰å®‰ä¸œç«™": "ä¹‰å®‰", "æ½®é˜³ç«™": "ä¹‰å®‰", "æ¾„æµ·ç«™": "ä¹‰å®‰", "æƒ æ¥ç«™": "ä¹‰å®‰", "ä¹‰å®‰æœºåœºç«™": "ä¹‰å®‰",
        "æ¸…æ¡“ç«™": "æ¸…æ’", "æ¸…æ¡“æœºåœºç«™": "æ¸…æ’", "æ¸…æ¡“å—ç«™": "æ¸…æ’",

        // â– å…‰æ½®éƒ½å¸‚åœˆ
        "å…‰è¾°ç«™": "å…‰è¾°", "å…‰è¾°ä¸œç«™": "å…‰è¾°", "ä¸Šé›ç«™": "å…‰è¾°", "é¾™æ±Ÿç«™": "å…‰è¾°",
        "æ½®å·ç«™": "æ½®å·", "é¥¶å¹³ç«™": "æ½®å·",
        "å…´åº†ç«™": "å…´åº†", "å…´åº†è¥¿ç«™": "å…´åº†",

        // â– å…¶ä»–
        "å¹¿é™µç«™": "å‡Œç³»",     // å‡Œç³»-å¹¿é™µåºœ-å¹¿é™µç«™
        "é’é˜³ç«™": "æ¥šç³»",     // æ¥šç³»-é’é˜³åºœ-é’é˜³ç«™
        "é’é˜³æœºåœºç«™": "æ¥šç³»",  // æ¥šç³»-é’é˜³åºœ-é’é˜³æœºåœºç«™
        "äº‘é™µç«™": "äº‘ç³»",     // äº‘ç³»-äº‘é™µåºœ-äº‘é™µç«™
        "ç¿é™Œç«™": "äº‘ç³»",     // äº‘ç³»-ç¿é™Œå›½-ç¿é™Œç«™
        "å¤©è½©ç«™": "å¤©è½©",     // è¡Œåœ¨-å¤©è½©åºœ-å¤©è½©ç«™
        "é•‡é™‡ç«™": "é™‡ç³»",     // é™‡ç³»-é•‡é™‡åºœ-é•‡é™‡ç«™
        "é•‡æ¸Šç«™": "æ®·ç³»",     // æ®·ç³»-é•‡æ¸Šåºœ-é•‡æ¸Šç«™
        "å»¶å¹³åŒ—ç«™": "å”ç³»",   // å”ç³»-å»¶å¹³åºœ-å»¶å¹³åŒ—ç«™
        "ç‡•äº‘å¤§é’ç«™": "æ™¯åœ£", // æ™¯åœ£-ç‡•äº‘åºœ-ç‡•äº‘å¤§é’ç«™
        "é’æ¢ç«™": "é¢œç³»"      // é¢œç³»-é’æ¢åºœ-é’æ¢ç«™
    };

    // ==================================================================================
    // 3. æ ¸å¿ƒè®¡ç®—å¼•æ“
    // ==================================================================================
    function findCheapestRoute() {
        const startStation = document.getElementById('start').value;
        const endStation = document.getElementById('end').value;
        const seatClass = document.querySelector('input[name="seat"]:checked').value;

        if (!startStation || !endStation) {
            document.getElementById('result').innerHTML = `âŒ é”™è¯¯ï¼šè¯·å…ˆé€‰æ‹©è½¦ç«™ï¼`;
            return;
        }

        const startRegion = stations[startStation];
        const endRegion = stations[endStation];

        // 1. åŒåœ°åŒºåˆ¤æ–­
        if (startRegion === endRegion) {
            const fare = seatClass === 'jia' ? 300 : 200;
            document.getElementById('result').innerHTML = `âœ… åŒåœ°åŒºé€šå‹¤<br>ğŸ’° <strong>${fare} æ–‡</strong> (èµ·æ­¥ä»·)`;
            return;
        }

        // 2. å¯»æ‰¾æœ€çŸ­è·¯å¾„
        const result = findShortestPath(startRegion, endRegion);
        
        if (!result) {
            document.getElementById('result').innerHTML = `âŒ é”™è¯¯ï¼šæ— é€šè·¯ï¼`;
            return;
        }

        const { distance, path, steps } = result;
        
        // 3. è®¡ç®—ç¥¨ä»· (å…³é”®ä¿®æ”¹ç‚¹)
        // ä¹™ç­‰åº§æ€»ç¥¨ä»· = 200(èµ·æ­¥) + distance(å„æ®µè·¨åŒºè´¹ä¹‹å’Œ)
        // ç”²ç­‰åº§æ€»ç¥¨ä»· = 300(èµ·æ­¥) + (å„æ®µè·¨åŒºè´¹+100)ä¹‹å’Œ
        // ç”²ç­‰åº§ä¹Ÿå¯ä»¥ç†è§£ä¸ºï¼šä¹™ç­‰ç¥¨ä»· + (100 * è·¨åŒºæ®µæ•°)
        
        const baseFareYi = 200;
        const baseFareJia = 300;
        
        const yiTotal = baseFareYi + distance;
        const jiaTotal = baseFareJia + distance + (steps * 100); 

        let displayText = `ğŸ›£ï¸ è·¯çº¿: ${path.join(" â†’ ")}<br>ğŸ§® è·¨åŒºæ®µæ•°: ${steps} æ®µ`;

        if (seatClass === 'yibei') {
            displayText += `<br>ğŸ« ä¹™ç­‰åº§: ${yiTotal} æ–‡`;
        } else {
            displayText += `<br>ğŸ‘‘ ç”²ç­‰åº§: ${jiaTotal} æ–‡<br><small>(èµ·æ­¥300 + è·¨åŒºè´¹${distance} + æœåŠ¡è´¹${steps * 100})</small>`;
        }

        document.getElementById('result').innerHTML = displayText;
    }

    // Dijkstra ç®—æ³• (æœªå˜)
    function findShortestPath(start, end) {
        const distances = {};
        const previous = {};
        const visited = new Set();
        const pq = [];

        for (let node in connections) {
            distances[node] = Infinity;
            previous[node] = null;
        }
        distances[start] = 0;
        pq.push({ node: start, dist: 0 });

        while (pq.length > 0) {
            pq.sort((a, b) => a.dist - b.dist);
            const { node: current, dist: currentDist } = pq.shift();

            if (visited.has(current)) continue;
            visited.add(current);

            if (current === end) {
                const path = [];
                let step = current;
                let stepCount = 0;
                while (step !== null) {
                    path.unshift(step);
                    if (previous[step]) stepCount++;
                    step = previous[step];
                }
                return { distance: currentDist, path: path, steps: stepCount };
            }

            const neighbors = connections[current];
            for (let neighbor in neighbors) {
                if (!visited.has(neighbor)) {
                    const newDist = currentDist + neighbors[neighbor];
                    if (newDist < distances[neighbor]) {
                        distances[neighbor] = newDist;
                        previous[neighbor] = current;
                        pq.push({ node: neighbor, dist: newDist });
                    }
                }
            }
        }
        return null;
    }

    // ==================================================================================
    // 4. é¡µé¢åˆå§‹åŒ–
    // ==================================================================================
    window.onload = function() {
        const startSelect = document.getElementById('start');
        const endSelect = document.getElementById('end');

        for (let code in stations) {
            const opt1 = new Option(`${code} (${stations[code]})`, code);
            const opt2 = new Option(`${code} (${stations[code]})`, code);
            startSelect.add(opt1);
            endSelect.add(opt2);
        }
    };
</script>

</body>
</html>
